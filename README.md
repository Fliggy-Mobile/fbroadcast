<p align="center">
  <a href="https://github.com/Fliggy-Mobile">
    <img width="200" src="https://gw.alicdn.com/tfs/TB1a288sxD1gK0jSZFKXXcJrVXa-360-360.png">
  </a>
</p>

<h1 align="center">fbroadcast</h1>


<div align="center">

<p>å°†å¤æ‚ç®€å•åŒ–ï¼Œä¸”æ˜“äºç®¡ç†ã€‚</p>

<p>FBroadcast å¸®åŠ©å¼€å‘è€…åœ¨åº”ç”¨å†…å»ºç«‹ä¸€å¥—é«˜æ•ˆçš„å¹¿æ’­ç³»ç»Ÿï¼Œæ”¯æŒç²˜æ€§å¹¿æ’­ã€‚</p>

<p><strong>ä¸»ç†äººï¼š<a href="">CoorChice</a>(<a href="coorchice.cb@alibaba-inc.com">coorchice.cb@alibaba-inc.com</a>)</strong></p>

<p>

<a href="https://pub.dev/packages/fbroadcast#-readme-tab-">
    <img height="20" src="https://img.shields.io/badge/Version-1.0.0-important.svg">
</a>


<a href="https://github.com/Fliggy-Mobile/fbroadcast">
    <img height="20" src="https://img.shields.io/badge/Build-passing-brightgreen.svg">
</a>


<a href="https://github.com/Fliggy-Mobile">
    <img height="20" src="https://img.shields.io/badge/Team-FAT-ffc900.svg">
</a>

<a href="https://www.dartcn.com/">
    <img height="20" src="https://img.shields.io/badge/Language-Dart-blue.svg">
</a>

<a href="https://pub.dev/documentation/fbroadcast/latest/fbroadcast/fbroadcast-library.html">
    <img height="20" src="https://img.shields.io/badge/API-done-yellowgreen.svg">
</a>

<a href="http://www.apache.org/licenses/LICENSE-2.0.txt">
   <img height="20" src="https://img.shields.io/badge/License-Apache--2.0-blueviolet.svg">
</a>

<p>
<p>

</div>

![](https://gw.alicdn.com/tfs/TB1fsXYij39YK4jSZPcXXXrUFXa-1024-602.png)

**[English](https://github.com/Fliggy-Mobile/fbroadcast) | ç®€ä½“ä¸­æ–‡**

> æ„Ÿè§‰è¿˜ä¸é”™ï¼Ÿè¯·æŠ•å‡ºæ‚¨çš„ **Star** å§ ğŸ¥° ï¼

# âœ¨ ç‰¹æ€§

æ¥çœ‹çœ‹ **FBroadcast** ä¸ºå¼€å‘è€…æä¾›äº†é‚£äº›ä¸å¯æ€è®®çš„èƒ½åŠ›æ”¯æŒï¼š

- æ”¯æŒ**å‘é€**å’Œ**æ¥æ”¶**æŒ‡å®šç±»å‹çš„æ¶ˆæ¯

- æ¶ˆæ¯æ”¯æŒæºå¸¦**ä»»æ„ç±»å‹**æ•°æ®åŒ…

- æä¾›**ç¯å¢ƒæ³¨å†Œ**ï¼Œä¸€è¡Œä»£ç å³å¯ç§»é™¤ç¯å¢ƒå†…æ‰€æœ‰æ¥æ”¶è€…

- ä¸å¯æ€è®®çš„**ç²˜æ€§å¹¿æ’­**

# ğŸ›  ä½¿ç”¨æŒ‡å—

**FBroadcast** æ˜¯ä¸€å¥—é«˜æ•ˆçµæ´»çš„**å¹¿æ’­ç³»ç»Ÿ**ï¼Œå¯ä»¥å¸®åŠ©å¼€å‘è€…**è½»æ¾ã€æœ‰åº**çš„æ„å»ºå…·æœ‰æå…·å¤æ‚æ€§çš„**å…³è”äº¤äº’**å’Œ**çŠ¶æ€å˜åŒ–**çš„ç²¾ç¾åº”ç”¨ã€‚


![](https://gw.alicdn.com/tfs/TB1xVcSe9R26e4jSZFEXXbwuXXa-1456-528.png)


**FBroadcast** å°†ä¸ºæ„å»ºå¤æ‚çš„ç²¾ç¾åº”ç”¨å¸¦æ¥é‚£äº›æ˜¾è€Œæ˜“è§çš„æ”¹å˜å‘¢ï¼Ÿ

- **Widget/æ¨¡å—é—´çš„å®Œå…¨è§£è€¦**  
 
    é€šè¿‡ **FBroadcast** é«˜æ•ˆçš„å¹¿æ’­ç³»ç»Ÿï¼Œå¼€å‘è€…å¯ä»¥è½»æ˜“çš„å®Œæˆ**Widget/æ¨¡å—**çš„è§£è€¦ã€‚åœ¨åº”ç”¨æ„å»ºçš„æ—¶å€™ï¼Œç»å¸¸éœ€è¦ **Widget/æ¨¡å—Aã€Bã€Cã€..** ä¹‹é—´æ ¹æ®äº¤äº’æ“ä½œäº’ç›¸å˜æ›´çŠ¶æ€æˆ–æ•°æ®ï¼Œå¼€å‘è€…ä»¬ä¸å¾—ä¸ä¸ºæ­¤è®©å„ä¸ª**Widget/æ¨¡å—äº’ç›¸ä¾èµ–**æˆ–è€…ä¸ºå®ƒä»¬å»ºç«‹**ç»Ÿä¸€çš„çŠ¶æ€ç®¡ç†**ï¼Œè¿™èƒ½è§£å†³é—®é¢˜ï¼Œä½†è¿™è®©æ„å»ºå˜å¾—éº»çƒ¦ï¼Œä¹Ÿè®©å˜æ›´å˜å¾—éš¾ä»¥è¿›è¡Œã€‚
    
    **FBroadcast** é€šè¿‡å»ºç«‹èµ·**ç®€å•ã€æœ‰æ•ˆã€æ˜ç¡®**å¹¿æ’­ç³»ç»Ÿï¼Œä½¿å¾—åœ¨ä»»æ„**Widget/æ¨¡å—**ä¸­**ä»»æ„æ—¶åˆ»/ä½ç½®**çš„æ”¹å˜èƒ½å¤Ÿä¸»åŠ¨å‘å‡ºå¹¿æ’­ï¼Œè€Œéœ€è¦æ ¹æ®è¿™äº›å˜æ›´ä½œå‡º**å“åº”æˆ–æ›´æ–°è§†å›¾**çš„**Widget/æ¨¡å—**åªéœ€è¦æ³¨å†Œç›¸åº”çš„**ä¿¡æ¯æ¥æ”¶å™¨**ï¼Œå°±å¯ä»¥åœ¨å˜æ›´å‘ç”Ÿæ—¶ï¼Œæ¥æ”¶åˆ°æ¶ˆæ¯ï¼Œä½œå‡ºå“åº”ã€‚è¿™ä½¿å¾—å…³è”æ¨¡å—é—´ä¸å†éœ€è¦äº’ç›¸ä¾èµ–ï¼Œæˆ–æ˜¯ä¸ºå®ƒä»¬è®¾è®¡å»ºç«‹ç»Ÿä¸€çš„çŠ¶æ€ç®¡ç†å™¨ã€‚
    
    **ååˆ†ç®€å•ï¼Œè½»é‡ï¼Œå’Œæ˜“äºå˜æ›´**ã€‚å½“ä¸€ä¸ª**Widget/æ¨¡å—**ä¸åœ¨éœ€è¦æ ¹æ®å¦ä¸€ä¸ª**Widget/æ¨¡å—**çš„å˜æ›´è€Œæ›´æ–°æ—¶ï¼Œåªéœ€ç§»é™¤å…¶ä¸­çš„**æ¥æ”¶å™¨**å³å¯ï¼Œè€Œä¸ç”¨ä¸ºæ­¤è€Œå¤§æ”¹**ä¾èµ–å…³ç³»**æˆ–æ˜¯**çŠ¶æ€ç®¡ç†å™¨**ã€‚

- **ç®€å•ã€çµæ´»ã€æ˜ç¡®ã€æ˜“ç®¡ç†**  

    **FBroadcast**  ä¸ºå¼€å‘è€…æä¾›äº†å¯ä»¥åœ¨ä»»æ„æ—¶åˆ»å‘é€å¹¿æ’­ï¼Œå’Œæ³¨å†Œ/ç§»é™¤æ¥æ”¶å™¨çš„èƒ½åŠ›ï¼Œæ¯«æ— çº¦æŸå’Œçµæ´»ã€‚
    
    å¹¿æ’­å’Œæ¥æ”¶å™¨ä¹‹é—´é€šè¿‡æ˜ç¡®çš„ç±»å‹ï¼ˆå­—ç¬¦ä¸²ï¼‰æ¥äº’ç›¸ç¡®è®¤èº«ä»½ï¼ŒæŒ‡å®šç±»å‹çš„å¹¿æ’­ï¼Œåªèƒ½è¢«æŒ‡å®šç±»å‹çš„æ¥æ”¶å™¨æ¥æ”¶ã€‚
    
    **FBroadcast** æä¾›äº†ç¯å¢ƒæ³¨å†Œæ”¯æŒï¼Œå¼€å‘è€…å¯ä»¥åœ¨ç¯å¢ƒè§£æ„æ—¶ï¼Œé€šè¿‡ [unregister()] å‡½æ•°ä¸€æ¬¡æ€§ç§»é™¤ç¯å¢ƒä¸­çš„æ‰€æœ‰ç±»å‹æ¥æ”¶å™¨ï¼Œè€Œæ— éœ€è®°å¿†å’Œå…³å¿ƒç©¶ç«Ÿéœ€è¦ç§»é™¤é‚£äº›æ¥æ”¶å™¨ã€‚ä¾‹å¦‚ï¼Œå¼€å‘è€…å¯ä»¥åœ¨ **Widget** çš„ `dispose()` ä¸­ï¼Œå°†æ³¨å†Œåœ¨è¯¥ **Widget** ä¸­çš„æ‰€æœ‰æ¥æ”¶å™¨ä¸€æ¬¡æ€§å…¨éƒ¨ç§»é™¤ã€‚
    
    
    


## äº‹ä»¶å¹¿æ’­


## ç²˜æ€§å¹¿æ’­


## ç¯å¢ƒæ³¨å†Œ

## Api è¯´æ˜

### æ³¨å†Œæ¥æ”¶è€…

```dart
/// æ³¨å†ŒæŒ‡å®šç±»å‹çš„æ¥æ”¶è€…ã€‚
/// å¦‚æœä¼ å…¥äº† [context] ç¯å¢ƒï¼Œè¯¥æ¥æ”¶è€…å°†ä¼šè¢«æ³¨å†Œåˆ°ç¯å¢ƒä¸­ã€‚ç¯å¢ƒå¯ä»¥æ˜¯ä»»æ„ç±»å‹çš„å¯¹è±¡ï¼Œä¾‹å¦‚ï¼šé¡µé¢ã€ç±»..
/// æ¥æ”¶è€…é€šè¿‡ [value] å¯ä»¥è·å–åˆ°æœ¬æ¡æ¶ˆæ¯æºå¸¦çš„æ•°æ®ã€‚
/// å½“è°ƒç”¨ [unregister] æ—¶ï¼Œè¯¥æ¥æ”¶è€…å³ä¼šè¢«æ¸…é™¤ã€‚
/// [key] - æ¶ˆæ¯ç±»å‹
/// [receiver] - æ¥æ”¶è€…
/// [context] - ç¯å¢ƒã€‚ä¸ä¸ºnullï¼Œ[receiver] å°†ä¼šè¢«æ³¨å†Œåˆ°ç¯å¢ƒä¸­ã€‚
///
/// Register recipients of the specified type.
/// If the [context] environment is passed in, the recipient will be registered in the environment. The environment can be any type of object, for example: page, class...
/// The receiver can get the data carried in this message through [value].
/// When [unregister] is called, the receiver will be cleared.
/// [key]-message type
/// [receiver] - receiver
/// [context] - context. Not null, [receiver] will be registered in the environment.
FBroadcast register(String key, VoidCallback receiver, {Object context})
```

### å‘é€å¹¿æ’­

#### æ™®é€šå¹¿æ’­

```dart
/// å¹¿æ’­ä¸€æ¡ [key] ç±»å‹çš„æ¶ˆæ¯ã€‚
/// å·²ç»æ³¨å†Œåœ¨ç³»ç»Ÿä¸­çš„æ¥æ”¶è€…å°†ä¼šæ¥æ”¶åˆ°æœ¬æ¡æ¶ˆæ¯ã€‚
/// æ¥æ”¶è€…é€šè¿‡ [value] å¯ä»¥è·å–åˆ°æœ¬æ¡æ¶ˆæ¯æºå¸¦çš„æ•°æ®ã€‚
/// [key] - æ¶ˆæ¯ç±»å‹
/// [value] - æ¶ˆæ¯æºå¸¦çš„æ•°æ®ã€‚å¯ä»¥æ˜¯ä»»æ„ç±»å‹æˆ–æ˜¯nullã€‚
///
/// Broadcast a message of type [key].
/// Recipients already registered in the system will receive this message.
/// The receiver can get the data carried in this message through [value].
/// [key] - Message type
/// [value] - The data carried in the message. Can be any type or null.
void broadcast(String key, [dynamic value])
```

#### å‘é€ç²˜æ€§å¹¿æ’­

```dart
/// å¹¿æ’­ä¸€æ¡ [key] ç±»å‹çš„ç²˜æ€§æ¶ˆæ¯ã€‚
/// å¦‚æœå¹¿æ’­ç³»ç»Ÿä¸­è¿˜æœ‰æ²¡æ³¨å†Œè¯¥ç±»å‹çš„æ¥æ”¶è€…ï¼Œæœ¬æ¡æ¶ˆæ¯å°†è¢«æ»ç•™åœ¨ç³»ç»Ÿä¸­ã€‚ä¸€æ—¦æœ‰è¯¥ç±»å‹æ¥æ”¶è€…è¢«æ³¨å†Œï¼Œæœ¬æ¡æ¶ˆæ¯å°†ä¼šè¢«ç«‹å³å‘é€ç»™æ¥æ”¶è€…ã€‚
/// å¦‚æœç³»ç»Ÿä¸­å·²ç»æ³¨å†Œæœ‰è¯¥ç±»å‹çš„æ¥æ”¶è€…ï¼Œæœ¬æ¡æ¶ˆæ¯å°†ä¼šè¢«ç«‹å³å‘é€ç»™æ¥æ”¶è€…ã€‚
/// æ¥æ”¶è€…é€šè¿‡ [value] å¯ä»¥è·å–åˆ°æœ¬æ¡æ¶ˆæ¯æºå¸¦çš„æ•°æ®ã€‚
/// [key] - æ¶ˆæ¯ç±»å‹
/// [value] - æ¶ˆæ¯æºå¸¦çš„æ•°æ®ã€‚å¯ä»¥æ˜¯ä»»æ„ç±»å‹æˆ–æ˜¯nullã€‚
///
/// Broadcast a sticky message of type [key].
/// If there are unregistered receivers of this type in the broadcast system, this message will be stuck in the system. Once a recipient of this type is registered, this message will be sent to the recipient immediately.
/// If this type of receiver is already registered in the system, this message will be sent to the receiver immediately.
/// The receiver can get the data carried in this message through [value].
///
/// [key] - Message type
/// [value] - The data carried in the message. Can be any type or null.
void stickyBroadcast(String key, [dynamic value])
```

#### ç²˜æ€§å¹¿æ’­

```dart
/// å¹¿æ’­ä¸€æ¡ [key] ç±»å‹çš„ç²˜æ€§æ¶ˆæ¯ã€‚
/// å¦‚æœå¹¿æ’­ç³»ç»Ÿä¸­è¿˜æœ‰æ²¡æ³¨å†Œè¯¥ç±»å‹çš„æ¥æ”¶è€…ï¼Œæœ¬æ¡æ¶ˆæ¯å°†è¢«æ»ç•™åœ¨ç³»ç»Ÿä¸­ã€‚ä¸€æ—¦æœ‰è¯¥ç±»å‹æ¥æ”¶è€…è¢«æ³¨å†Œï¼Œæœ¬æ¡æ¶ˆæ¯å°†ä¼šè¢«ç«‹å³å‘é€ç»™æ¥æ”¶è€…ã€‚
/// å¦‚æœç³»ç»Ÿä¸­å·²ç»æ³¨å†Œæœ‰è¯¥ç±»å‹çš„æ¥æ”¶è€…ï¼Œæœ¬æ¡æ¶ˆæ¯å°†ä¼šè¢«ç«‹å³å‘é€ç»™æ¥æ”¶è€…ã€‚
/// æ¥æ”¶è€…é€šè¿‡ [value] å¯ä»¥è·å–åˆ°æœ¬æ¡æ¶ˆæ¯æºå¸¦çš„æ•°æ®ã€‚
/// [key] - æ¶ˆæ¯ç±»å‹
/// [value] - æ¶ˆæ¯æºå¸¦çš„æ•°æ®ã€‚å¯ä»¥æ˜¯ä»»æ„ç±»å‹æˆ–æ˜¯nullã€‚
///
/// Broadcast a sticky message of type [key].
/// If there are unregistered receivers of this type in the broadcast system, this message will be stuck in the system. Once a recipient of this type is registered, this message will be sent to the recipient immediately.
/// If this type of receiver is already registered in the system, this message will be sent to the receiver immediately.
/// The receiver can get the data carried in this message through [value].
///
/// [key] - Message type
/// [value] - The data carried in the message. Can be any type or null.
void stickyBroadcast(String key, [dynamic value])
```

#### è·å–æŒ‡å®šæ¶ˆæ¯çš„æ•°æ®åŒ…

```dart
/// æ¥æ”¶è€…å¯ä»¥é€šè¿‡è¯¥å‡½æ•°è·å–æ¶ˆæ¯ä¸­æºå¸¦çš„æ•°æ®
///
/// The receiver can obtain the data carried in the message through this function
dynamic value(String key)
```

#### ç§»é™¤æŒ‡å®šæ¥æ”¶è€…

```dart
/// ç§»é™¤æŒ‡å®šçš„æ¥æ”¶è€… [receiver]ã€‚
/// å¦‚æœæŒ‡å®šäº† [key]ã€[context] å°†æœ‰åŠ©äºæ›´å¿«çš„ç§»é™¤æŒ‡å®šæ¥æ”¶è€…ã€‚
/// [receiver] - æ¥æ”¶è€…
/// [key] - æ¶ˆæ¯ç±»å‹
/// [context] - ç¯å¢ƒã€‚
///
/// Remove the specified receiver [receiver].
/// If [key] and [context] are specified, it will help to remove the specified recipient faster.
/// [receiver] - receiver
/// [key]-message type
/// [context] - context.
FBroadcast remove(VoidCallback receiver, {String key, Object context})
```

#### ç§»é™¤æŒ‡å®šç±»å‹çš„æ‰€æœ‰æ¥æ”¶è€…

```dart
/// ç§»é™¤å¹¿æ’­ç³»ç»Ÿä¸­çš„æŒ‡å®š [key] ç±»å‹çš„æ‰€æœ‰æ¥æ”¶è€…ï¼Œä»¥åŠè¯¥ç±»å‹çš„ç²˜æ€§å¹¿æ’­ã€‚
/// [key] - ç±»å‹
///
/// Remove all receivers of the specified [key] type in the broadcast system and sticky broadcasts of that type.
///  [key] - type
void clear(String key)
```


#### ç§»é™¤ç¯å¢ƒå†…æ‰€æœ‰æ¥æ”¶è€…

```dart
/// ç§»é™¤å¹¿æ’­ç³»ç»Ÿä¸­ï¼Œæ³¨å†Œåˆ° [context] ç¯å¢ƒå†…çš„æ‰€æœ‰æ¥æ”¶è€…ã€‚
/// ä¾‹å¦‚ï¼Œåœ¨é¡µé¢å…³é—­æ—¶ï¼Œå¼€å‘è€…å¯ä»¥é€šè¿‡ [unregister] ä¸€æ¬¡æ€§ç§»é™¤æ³¨å†Œåˆ°è¯¥ç¯å¢ƒå†…çš„æ‰€æœ‰æ¥æ”¶è€…ã€‚
/// å½“ç„¶ï¼Œå‰ææ—¶åœ¨æ¥æ”¶è€…é€šè¿‡ [register] æ³¨å†Œçš„æ—¶å€™ï¼Œä¼ å…¥ [context]ï¼Œå°†æ¥æ”¶è€…æ³¨å†Œåˆ°è¯¥ç¯å¢ƒä¸­ã€‚
/// [context] - ç¯å¢ƒã€‚
///
/// Remove all receivers registered in the [context] environment from the broadcast system.
/// For example, when the page is closed, the developer can use [unregister] to remove all recipients registered in the environment at once.
/// Of course, the prerequisite is that when the receiver registers through [register], pass in [context] to register the receiver to the environment.
/// [context] - context.
void unregister(Object context)
```


#### é‡Šæ”¾å¹¿æ’­ç³»ç»Ÿ

```dart
/// ä¼šç§»é™¤å¹¿æ’­ç³»ç»Ÿä¸­çš„æ‰€æœ‰çš„æ¥æ”¶è€…ï¼Œä»¥åŠç²˜æ€§å¹¿æ’­ã€‚
///
/// Remove all receivers in the broadcasting system, and sticky broadcasting.
void dispose()
```

# ğŸ˜ƒ å¦‚ä½•ä½¿ç”¨ï¼Ÿ

åœ¨é¡¹ç›® `pubspec.yaml` æ–‡ä»¶ä¸­æ·»åŠ ä¾èµ–ï¼š

## ğŸŒ pub ä¾èµ–æ–¹å¼

```
dependencies:
  fbroadcast: ^<ç‰ˆæœ¬å·>
```

> âš ï¸ æ³¨æ„ï¼Œè¯·åˆ° [**pub**](https://pub.dev/packages/fbroadcast) è·å– **FBroadcast** æœ€æ–°ç‰ˆæœ¬å·

## ğŸ–¥ git ä¾èµ–æ–¹å¼

```
dependencies:
  fbroadcast:
    git:
      url: 'git@github.com:Fliggy-Mobile/fbroadcast.git'
      ref: '<åˆ†æ”¯å· æˆ– tag>'
```


> âš ï¸ æ³¨æ„ï¼Œåˆ†æ”¯å· æˆ– tag è¯·ä»¥ [**FBroadcast**](https://github.com/Fliggy-Mobile/fbroadcast) å®˜æ–¹é¡¹ç›®ä¸ºå‡†ã€‚


# ğŸ’¡ License

```
Copyright 2020-present Fliggy Android Team <alitrip_android@list.alibaba-inc.com>.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at following link.

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.

```


### æ„Ÿè§‰è¿˜ä¸é”™ï¼Ÿè¯·æŠ•å‡ºæ‚¨çš„ [**Star**](https://github.com/Fliggy-Mobile/fbroadcast) å§ ğŸ¥° ï¼


---

# å¦‚ä½•è¿è¡Œ Demo å·¥ç¨‹ï¼Ÿ

1.**clone** å·¥ç¨‹åˆ°æœ¬åœ°

2.è¿›å…¥å·¥ç¨‹ `example` ç›®å½•ï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤

```
flutter create .
```

3.è¿è¡Œ `example` ä¸­çš„ Demo



